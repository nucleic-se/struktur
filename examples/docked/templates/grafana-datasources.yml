# Generated from stack: {{global.stack_name}}
# Datasources derived from monitors/monitored_by relationships
apiVersion: 1

datasources:
{{#each instances_by_id}}
{{#if (eq id "grafana")}}
{{#each relations.[monitors/monitored_by]}}
{{#with (lookup ../../instances_by_id this)}}
  - name: {{capitalize id}}{{#if aspects.docker_container.datasource_name}} {{aspects.docker_container.datasource_name}}{{/if}}
    type: redis-datasource
    access: proxy
    url: {{id}}:{{#if aspects.docker_container.redis_port}}{{aspects.docker_container.redis_port}}{{else}}{{#if aspects.docker_container.ports}}{{split (first aspects.docker_container.ports) ":" 1}}{{else}}6379{{/if}}{{/if}}
    isDefault: {{#if @first}}true{{else}}false{{/if}}
    editable: false
    jsonData:
      client: standalone
{{/with}}
{{/each}}
{{/if}}
{{/each}}

