{
  "$id": "api",
  "$class": "docked_container",
  "description": "Backend API service handling business logic and data access",
  "domains": [
    "application",
    "api"
  ],
  "$aspects": {
    "aspect_docker_container": {
      "image": "node:20-alpine",
      "description": "Backend API connecting database, cache, and frontend",
      "command": "sh -c 'npm install && node server.js'",
      "working_dir": "/app",
      "ports": [
        "3001:3001"
      ],
      "volumes": [
        "./api:/app"
      ],
      "environment": {
        "NODE_ENV": "${NODE_ENV:-development}",
        "PORT": "3001",
        "DATABASE_URL": "postgresql://${POSTGRES_USER:-docked}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB:-docked_app}",
        "REDIS_URL": "redis://redis:6379",
        "REDIS_PASSWORD": "${REDIS_PASSWORD}",
        "API_SECRET": "${API_SECRET}",
        "LOG_LEVEL": "${LOG_LEVEL:-info}"
      },
      "depends_on": [
        "postgres",
        "redis"
      ],
      "healthcheck": {
        "test": [
          "CMD",
          "wget",
          "--no-verbose",
          "--tries=1",
          "--spider",
          "http://localhost:3001/health"
        ],
        "interval": "15s",
        "retries": "3",
        "start_period": "30s"
      },
      "deploy": {
        "resources": {
          "limits": {
            "cpus": "1.0",
            "memory": "1G"
          },
          "reservations": {
            "cpus": "0.25",
            "memory": "256M"
          }
        }
      }
    }
  },
  "relations": {
    "uses/used_by": [
      "postgres",
      "redis"
    ],
    "serves/served_by": []
  }
}
