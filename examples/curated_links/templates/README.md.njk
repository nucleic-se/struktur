{# Import reusable macros #}
{% import "_macros.njk" as m %}

{# Extract data using filters (best practice: use selectattr instead of manual loops) #}
{% set links = instances | selectattr('class', 'equalto', 'tool_link') | list %}

{# Extract unique categories #}
{% set categories = [] %}
{% for link in links if link.category and link.category not in categories %}
  {% set categories = categories.concat([link.category]) %}
{% endfor %}
{% set categories = categories | sort %}

{# Collect all tags from all links #}
{% set all_tags_nested = [] %}
{% for link in links if link.tags %}
  {% set all_tags_nested = all_tags_nested.concat([link.tags]) %}
{% endfor %}
{# Flatten and deduplicate tags #}
{% set all_tags = [] %}
{% for tag_array in all_tags_nested %}
  {% set all_tags = all_tags.concat(tag_array) %}
{% endfor %}
{% set unique_tags = [] %}
{% for tag in all_tags if tag not in unique_tags %}
  {% set _ = unique_tags.push(tag) %}
{% endfor %}

# {{ instances_by_id['metadata'].title }}

{{ instances_by_id['metadata'].description }}

**Total Links:** {{ m.toolCount(instances) }}

---

## Table of Contents

{% for category in categories %}
- [{{ category }}](#{{ category | lower | replace(" ", "-") }})
{% endfor %}

---

{% for category in categories %}
{{ m.categorySection(category, links) }}

{% endfor %}

---

## Tags

Popular tags in this collection:

{% for tag in unique_tags | sort %}`{{ tag }}` {% endfor %}

---

<div align="center">
  <p><strong>Made with âš¡ <a href="https://github.com/nucleic-se/struktur">Struktur</a></strong></p>
  <p><em>Build system for coordinated configuration</em></p>
</div>
